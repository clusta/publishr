@{
    Layout = "_Layout.cshtml";
}

<div class="container" ng-app="blogpost">
    <div ui-view=""></div>
    <div ui-view="comment"></div>

    <script id="List.html" type="text/ng-template">
        <table class="table">
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="listing in result.data">
                    <td>{{listing.cards.medium.title}}</td>
                    <td>
                        <a href="#/details/{{listing.id}}" class="btn btn-primary">
                            View
                        </a>
                        <a href="#/edit/{{listing.id}}" class="btn btn-default">
                            Edit
                        </a>
                    </td>
                </tr>
            </tbody>
        </table>
    </script>

    <script id="Create.html" type="text/ng-template">
        <form name="form" ng-submit="createPage(form)">
            <h2>Create blog post</h2>
            <div class="form-group">
                <input class="form-control" type="text" ng-model="create.kind" readonly />
            </div>
            <div class="form-group">
                <input class="form-control" type="text" placeholder="Path" ng-model="create.path" ng-required />
            </div>
            <div class="form-group">
                <input class="form-control" type="text" placeholder="Title" ng-model="create.data.cards.medium.title" ng-required />
            </div>
            <button type="submit" class="btn btn-primary">Create</button>
        </form>
    </script>

    <script id="Details.html" type="text/ng-template">
        <div class="row">
            <div class="col-xs-12">
                <h1 class="page-header">{{resource.data.cards.medium.title}}</h1>
            </div>
        </div>
        <div ng-repeat="section in resource.data.sections">
            <div class="row">
                <div class="col-xs-12">
                    <h2>{{section.containers.header.blocks[0].body}}</h2>
                    <p>{{section.containers.content.blocks[0].body}}</p>
                </div>
            </div>
        </div>
    </script>

    <script id="Comment.html" type="text/ng-template">
        <form name="comment">
            <h2>Create comment</h2>
            <div class="form-group">
                <textarea class="form-control" placeholder="Enter your comment here" ng-model="create.data.text" ng-required></textarea>
            </div>
            <button class="btn btn-default" type="button" ng-click="createComment(comment)">Save</button>
        </form>
        <div ng-repeat="comment in list">
            <div class="row">
                <div class="col-xs-3">
                    {{comment.data.author.name}}<br />
                    {{comment.meta.created | date:'short'}}
                </div>
                <div class="col-xs-9">
                    <p>{{comment.data.text}}</p>
                </div>
            </div>
        </div>
    </script>

    <script id="Edit.html" type="text/ng-template">
        <h1>Edit: {{resource.content.cards.medium.title}}</h1>
        <form name="edit">
            <h2>Card (medium)</h2>
            <div class="form-group">
                <input class="form-control" type="text" placeholder="Title" ng-model="resource.data.cards.medium.title" ng-required />
            </div>
            <h2>Tags</h2>
            <div class="form-group">
                <input class="form-control" type="text" placeholder="New tag" ng-model="newTag" />
                <button class="btn btn-default" type="button" ng-click="addTag(newTag);newTag = '';">Add Tag</button>
            </div>
            <div class="form-group">
                <p>
                    <span ng-repeat="tag in resource.data.tags">
                        <span class="label label-default">
                            {{tag}}
                            <span class="glyphicon glyphicon-remove" ng-click="removeTag(tag)"></span>
                        </span>
                    </span>
                </p>
            </div>
            <h2>Sections</h2>
            <div ng-repeat="section in resource.data.sections">
                <div class="row">
                    <div class="col-xs-3">
                        {{$index + 1}}
                    </div>
                    <div class="col-xs-6">
                        <div class="form-group">
                            <input class="form-control" type="text" placeholder="Title" ng-model="section.containers.header.blocks[0].body" ng-required />
                        </div>
                        <div class="form-group">
                            <textarea class="form-control" placeholder="Content" ng-model="section.containers.content.blocks[0].body"></textarea>
                        </div>
                    </div>
                    <div class="col-xs-3">
                        <div ng-show="!$first">
                            <button type="button" ng-click="moveSectionUp(section)" class="btn btn-link">
                                <span class="glyphicon glyphicon-chevron-up"></span>
                                Move Up
                            </button>
                            <br />
                        </div>
                        <div ng-show="!$last">
                            <button type="button" ng-click="moveSectionDown(section)" class="btn btn-link">
                                <span class="glyphicon glyphicon-chevron-down"></span>
                                Move Down
                            </button>
                            <br />
                        </div>
                        <button type="button" ng-click="addSection($index)" class="btn btn-link">
                            <span class="glyphicon glyphicon-plus"></span>
                            Add Before
                        </button>
                        <br />
                        <button type="button" ng-click="addSection($index + 1)" class="btn btn-link">
                            <span class="glyphicon glyphicon-plus"></span>
                            Add After
                        </button>
                        <br />
                        <button type="button" ng-click="removeSection($index)" class="btn btn-link">
                            <span class="glyphicon glyphicon-remove"></span>
                            Remove
                        </button>
                    </div>
                </div>
                <hr ng-show="!$last" />
            </div>
            <div class="well" ng-if="resource.content.sections.length == 0">
                <button type="button" ng-click="addSection()">Add first section</button>
            </div>
            <button class="btn btn-primary" type="button" ng-click="updatePage(edit)">Save</button>
        </form>
    </script>
</div>

<script src="blogpost.js"></script>